<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=hapytex data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting." data-color=#e9c012 data-position=Right data-x_margin=18 data-y_margin=18></script><meta name=keywords content="Django,web,programming,antipattern,pattern,troubleshooting,software design,field,column,database,django-models "><meta name=author content="Willem Van Onsem"><meta name=description content="A set of Django (anti)patterns: patterns and things to avoid when building a web application with Django."><meta name=twitter:image:src content="https://repository-images.githubusercontent.com/257009680/7a954900-2f5d-11eb-8d0a-c8af0596107f"><meta name=og:title content="A certain field does not appear in the migrations and in the database table"><meta name=og:image content="https://repository-images.githubusercontent.com/257009680/7a954900-2f5d-11eb-8d0a-c8af0596107f"><meta name=og:image:alt content="A prohibition sign in the Django color scheme."><meta name=og:image:type content="image/png"><meta name=og:type content="website"><link rel=stylesheet href=https://cdn.rawgit.com/diversen/pandoc-bootstrap-adaptive-template/959c3622/template.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.3.2/styles/default.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css><script src=https://code.jquery.com/jquery-3.5.1.min.js></script><script src=https://cdn.rawgit.com/diversen/pandoc-bootstrap-adaptive-template/959c3622/menu/js/jquery.cookie.js></script><script src=https://cdn.rawgit.com/diversen/pandoc-bootstrap-adaptive-template/959c3622/menu/js/jquery.hoverIntent.minified.js></script><script src=https://cdn.rawgit.com/diversen/pandoc-bootstrap-adaptive-template/959c3622/menu/js/jquery.dcjqaccordion.2.7.min.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin=anonymous referrerpolicy=no-referrer><link href=/style.css rel=stylesheet><link href=https://cdn.rawgit.com/ryangrose/easy-pandoc-templates/948e28e5/css/elegant_bootstrap.css rel=stylesheet><script src=https://cdn.rawgit.com/diversen/pandoc-bootstrap-adaptive-template/959c3622/jquery.sticky-kit.js></script><script data-ad-client=ca-pub-9962024266760159 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script src=/script.js></script><link rel=icon href=/favicon.ico type=image/x-icon><meta name=generator content="pandoc"><title>A certain field does not appear in the migrations and in the database table &#8249; troubleshooting &#8249; Django antipatterns</title>
<link rel=stylesheet href></head><body><a class=github-fork-ribbon href=https://github.com/hapytex/django-antipatterns data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a><div class="navbar navbar-static-top"><div class=navbar-inner><div class=container><nav aria-label=section><ol class=breadcrumb><li class=breadcrumb-item><a href=/><i class="fas fa-home"></i></a><li class=breadcrumb-item><a href=/troubleshooting.html><i class="fas fa-bug"></i>&nbsp;
troubleshooting</a><li class="breadcrumb-item active" aria-current=page>A certain field does not appear in the migrations and in the database table</ol></nav><ul class="nav pull-right doc-info"></ul></div></div></div><article><div class=container><div class=row><div class=span12><p>There are several questions on <em>StackOverflow</em> regarding a field that is defined in a model, but does not appear in the database after making migrations and migrating.<h1 id=what-are-the-symptoms>What are the <em>symptoms</em>?</h1><p>If we inspect the migration file that was constructed by the <a href=https://docs.djangoproject.com/en/dev/ref/django-admin/#django-admin-makemigrations><strong><code>makemigrations</code></strong> command <sup>[Django-doc]</sup></a>, we see that only a subset of the fields (or none at all) are mentioned, and some fields that have been defined in the model are thus missing.<h1 id=what-is-a-possible-fix>What is a <em>possible</em> fix?</h1><p>Usually this is caused because we did not define that field correctly in the model. There are typically three variants to that problem.<h2 id=variant-1-trailing-comma>Variant 1: Trailing comma</h2><p>Some people tend to end the line of a field with a comma, for example:<pre class=python><code>from django.db import models

class MyModel(models.Model):
    #                     a trailing comma &downarrow;
    name = models.CharField(max_length=128)<b>,</b></code></pre><p>This will wrap the <code>CharField</code> in a singleton tuple (a tuple with one element). Django will look for items in the class that are subclasses of the <a href=https://docs.djangoproject.com/en/3.2/ref/models/fields/#field-options><strong><code>Field</code></strong> class <sup>[Django-doc]</sup></a>. While the tuple wraps a <code>CharField</code> that is a subclass of <code>Field</code>, a singleton tuple that contains such element is <em>not</em>, so Django will not recognize it.<p>In that case you thus drop the trailing comma, and work with:<pre class=python><code>from django.db import models

class MyModel(models.Model):
    #                    <i>no</i> trailing comma &downarrow;
    name = models.CharField(max_length=128)</code></pre><h2 id=variant-2-using-a-colon-between-the-name-of-the-field-and-the-field>Variant 2: Using a colon between the name of the field and the field</h2><p>Often people write classes like one writes a dictionary literal: with a colon (<code>:</code>) between the key and the value. This thus can look like:<pre class=python><code>from django.db import models

class MyModel(models.Model):
    #    &downarrow; a colon
    name <b>:</b> models.CharField(max_length=128)</code></pre><p>This is <em>not</em> a way to define a class attribute. The colon is used for annotations. Indeed, if we inspect <code>MyModel</code>, we see:<pre class=pycon><code>&gt;&gt;&gt; MyModel.name
Traceback (most recent call last):
  File &quot;&lt;console&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: type object &#39;MyModel&#39; has no attribute &#39;name&#39;</code></pre><p>Colons are here used to create <em>type annotations</em>. Indeed, if we inspect the <code>__annotations__</code> attribute of <code>MyModel</code>, we see:<pre class=pycon><code>&gt;&gt;&gt; MyModel.__annotations__
{&#39;name&#39;: &lt;django.db.models.fields.CharField&gt;}</code></pre><p>We here thus made an annotation to specify that <code>name</code> will have a certain type, but we never define <code>name</code> at the class level.<p>We thus should replace the colon with an equals sign (<code>=</code>):<pre class=python><code>from django.db import models

class MyModel(models.Model):
    #    &downarrow; <i>equals sign</i> instead of a colon
    name <b>=</b> models.CharField(max_length=128)</code></pre><h2 id=variant-3-mixing-form-fields-and-model-fields>Variant 3: mixing form fields and model fields</h2><p>Another common variant is mixing <em>model</em> fields with <em>form</em> fields. It is easy to make such mistake, since a lot of form fields have the same class name as their model field. Especially if one uses an IDE, and then for example writes <code>CharField</code>, it is possible that the IDE will propose to import the wrong module. This thus could look like:<pre class=python><code>from django.db import models
from django.forms import <b>CharField</b>

class MyModel(models.Model):
    #         &downarrow; CharField from the django.forms module
    name = <b>CharField(</b>max_length=128<b>)</b></code></pre><p>Since this <code>CharField</code> does not inherit from the <code>Field</code> of the <code>django.db.models</code> module, again Django will not see this as a field that should be included in the migration.<p>In Django <em>model fields</em> focus in <em>storing</em> data in the database, whereas <em>form fields</em> help to process data when a form is submitted. It thus makes no sense that model fields appear in forms, or that form fields appear in models.<p>Therefore it might be better to import the <code>django.db.models</code> module, and always use <code>models.CharField</code> in that case it gives a visual hint that it is using the correct field:<pre class=python><code>from django.db import models

class MyModel(models.Model):
    #         &downarrow; import from the models module.
    name = <b>models.</b>CharField(max_length=128)</code></pre></div></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.1/anchor.min.js integrity="sha512-zPB79j2C+3sFS9zcA3vg/z6bVKzJVEyu9pY5w89akQRys76zpAT2t6S3wZKla3QQ14O5l/Yt0RUQ/DHXx82Y5g==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.3.2/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><script>anchors.options={placement:"left",visible:"hover",icon:"¶"},anchors.add("h1,h2,h3")</script></article></body></html>