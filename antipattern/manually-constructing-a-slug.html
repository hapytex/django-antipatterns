<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=hapytex data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting." data-color=#e9c012 data-position=Right data-x_margin=18 data-y_margin=18></script><meta name=keywords content="Django,web,programming,antipattern,pattern,troubleshooting,software design,slug,url,uri,url-path,django-views,django-models ,true"><meta name=author content="Willem Van Onsem"><meta name=description content="A set of Django (anti)patterns: patterns and things to avoid when building a web application with Django."><meta name=twitter:image:src content="https://repository-images.githubusercontent.com/257009680/7a954900-2f5d-11eb-8d0a-c8af0596107f"><meta name=og:title content="Manually constructing a slug"><meta name=og:image content="https://repository-images.githubusercontent.com/257009680/7a954900-2f5d-11eb-8d0a-c8af0596107f"><meta name=og:image:alt content="A prohibition sign in the Django color scheme."><meta name=og:image:type content="image/png"><meta name=og:type content="website"><link rel=stylesheet href=https://cdn.rawgit.com/diversen/pandoc-bootstrap-adaptive-template/959c3622/template.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.3.2/styles/default.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css><script src=https://code.jquery.com/jquery-3.5.1.min.js></script><script src=https://cdn.rawgit.com/diversen/pandoc-bootstrap-adaptive-template/959c3622/menu/js/jquery.cookie.js></script><script src=https://cdn.rawgit.com/diversen/pandoc-bootstrap-adaptive-template/959c3622/menu/js/jquery.hoverIntent.minified.js></script><script src=https://cdn.rawgit.com/diversen/pandoc-bootstrap-adaptive-template/959c3622/menu/js/jquery.dcjqaccordion.2.7.min.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin=anonymous referrerpolicy=no-referrer><link href=/style.css rel=stylesheet><link href=https://cdn.rawgit.com/ryangrose/easy-pandoc-templates/948e28e5/css/elegant_bootstrap.css rel=stylesheet><script src=https://cdn.rawgit.com/diversen/pandoc-bootstrap-adaptive-template/959c3622/jquery.sticky-kit.js></script><script data-ad-client=ca-pub-9962024266760159 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script src=/script.js></script><link rel=icon href=/favicon.ico type=image/x-icon><meta name=generator content="pandoc"><title>Manually constructing a slug &#8249; antipattern &#8249; Django antipatterns</title><style>pre>code.sourceCode{white-space:pre;position:relative}pre>code.sourceCode>span{display:inline-block;line-height:1.25}pre>code.sourceCode>span:empty{height:1.2em}.sourceCode{overflow:visible}code.sourceCode>span{color:inherit;text-decoration:inherit}div.sourceCode{margin:1em 0}pre.sourceCode{margin:0}@media screen{div.sourceCode{overflow:auto}}@media print{pre>code.sourceCode{white-space:pre-wrap}pre>code.sourceCode>span{text-indent:-5em;padding-left:5em}}pre.numberSource code{counter-reset:source-line 0}pre.numberSource code>span{position:relative;left:-4em;counter-increment:source-line}pre.numberSource code>span>a:first-child::before{content:counter(source-line);position:relative;left:-1em;text-align:right;vertical-align:baseline;border:none;display:inline-block;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 4px;width:4em;color:#aaa}pre.numberSource{margin-left:3em;border-left:1px solid #aaa;padding-left:4px}div.sourceCode{}@media screen{pre>code.sourceCode>span>a:first-child::before{text-decoration:underline}}code span.al{color:red}code span.an{color:green}code span.at{}code span.bu{}code span.cf{color:#00f}code span.ch{color:teal}code span.cn{}code span.co{color:green}code span.cv{color:green}code span.do{color:green}code span.er{color:red;font-weight:700}code span.ex{}code span.im{}code span.in{color:green}code span.kw{color:#00f}code span.op{}code span.ot{color:#ff4000}code span.pp{color:#ff4000}code span.sc{color:teal}code span.ss{color:teal}code span.st{color:teal}code span.va{}code span.vs{color:teal}code span.wa{color:green;font-weight:700}</style><link rel=stylesheet href></head><body><a class=github-fork-ribbon href=https://github.com/hapytex/django-antipatterns data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a><div class="navbar navbar-static-top"><div class=navbar-inner><div class=container><nav aria-label=section><ol class=breadcrumb><li class=breadcrumb-item><a href=/><i class="fas fa-home"></i></a><li class=breadcrumb-item><a href=/antipattern.html><i class="fas fa-ban"></i>&nbsp;
antipattern</a><li class="breadcrumb-item active" aria-current=page>Manually constructing a slug</ol></nav><ul class="nav pull-right doc-info"><li><div class=rating data-rating=3>severity:
<i class=star-1>★</i>
<i class=star-2>★</i>
<i class=star-3>★</i>
<i class=star-4>★</i>
<i class=star-5>★</i></div></ul></div></div></div><article><div class=container><div class=row><div class=span12><p>Sometimes, people construct slugs manually, for example in a view with:<div class=sourceCode id=cb1><pre class="sourceCode python"><code class="sourceCode python"><span id=cb1-1><a href=#cb1-1 aria-hidden=true tabindex=-1></a>model_object.slug <span class=op>=</span> model_object.title.replace(<span class=st>&#39; &#39;</span>, <span class=st>&#39;-&#39;</span>)</span></code></pre></div><p>There are several variants of this approach, but often these replace space(s) with a hyphen.<h1 id=why-is-it-a-problem>Why is it a problem?</h1><p>Often such algorithms to create a slug are <em>not</em> sufficient. Indeed, for example if the title looks like <code>'foo costs $0.20'</code>, then the slug will be <code>'foo-costs-$0.20'</code>, but both <code>$</code> and <code>.</code> are characters that will not be accepted the <code>&lt;slug:…></code> path converter. While we can of course implement a method that will filter out these characters it is hard to filter out all characters that will not match the path converter.<p>Even if the algorithm is smart enough to filter out certain characters, it will often end up with <em>strange</em> slugs. Indeed, if we slugify <code>'drinking coffee in a café'</code>, we expect to see <code>'drinking-coffee-in-a-cafe'</code>, but if we remove all characters with a custom algorithm, we end up with <code>'drinking-coffee-in-a-caf'</code>.<p>Another scenario that is common is that a string might contain leading and trailing spaces, tabs, new lines, etc. In that case a simple slugify algorithm will replace this with a hyphen, and thus results in a slug with a leading or trailing hyphen, which looks strange as well. Indeed, if we would slugify <code>' to be or not to be'</code> with the simple slugify algorithm above, we obtain <code>'--to-be-or-not-to-be'</code>.<h1 id=what-can-be-done-to-resolve-the-problem>What can be done to resolve the problem?</h1><p>Django has a <a href=https://docs.djangoproject.com/en/dev/ref/utils/#django.utils.text.slugify><strong><code>slugify(…)</code></strong> function <sup>[Django-doc]</sup></a> which aims to do a <em>best effort</em> in converting a string to a slug. It will remove diacritics, convert the text to lower case, remove all non-ASCII characters, and eventually replace any sequence of white space or hyphens with a single hyphen. If we run the titles through the <code>slugify(…)</code> function, we obtain the following slugs:<pre class=pycon><code>&gt;&gt;&gt; from django.utils.text import slugify
&gt;&gt;&gt; slugify(&#39;foo-costs-$0.20&#39;)
&#39;foo-costs-020&#39;
&gt;&gt;&gt; slugify(&#39;drinking-coffee-in-a-café&#39;)
&#39;drinking-coffee-in-a-cafe&#39;
&gt;&gt;&gt; slugify(&#39;  to be or not to be&#39;)
&#39;to-be-or-not-to-be&#39;</code></pre><p>This means that this function will aim to create nice and valid slugs for the situations discussed above. Usually, it is better to work with utility functions that often cover "edge- and corner-cases" that indeed are not very common, but eventually if the number of blog posts will grow, some posts will have titles that can have invalid or ugly slug counterparts. Therefore it is in general better to work with a library that often deals with such cases in a better way.<h1 id=extra-tips>Extra tips</h1><p>Instead of creating a slug in a view, one can work with <a href=https://django-autoslug.readthedocs.io/en/latest/><strong><code>django-autoslug</code></strong> <sup>[readthedocs.io]</sup></a> and use an <a href=https://django-autoslug.readthedocs.io/en/latest/fields.html#autoslug.fields.AutoSlugField><strong><code>AutoSlugField</code></strong> <sup>[readthedocs.io]</sup></a> to automatically populate a slug field based on another field. This makes the model more <em>declarative</em>, and this field has extra logic to preserve <em>uniqueness</em>.<h1 id=related-packages>Related packages</h1><a href=https://github.com/justinmayer/django-autoslug><img alt="latest release of djang-autoslug" src="https://img.shields.io/github/v/tag/justinmayer/django-autoslug?color=%23092E20&label=djang-autoslug&logo=django"></a></div></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.1/anchor.min.js integrity="sha512-zPB79j2C+3sFS9zcA3vg/z6bVKzJVEyu9pY5w89akQRys76zpAT2t6S3wZKla3QQ14O5l/Yt0RUQ/DHXx82Y5g==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.3.2/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><script>anchors.options={placement:"left",visible:"hover",icon:"¶"},anchors.add("h1,h2,h3")</script></article></body></html>